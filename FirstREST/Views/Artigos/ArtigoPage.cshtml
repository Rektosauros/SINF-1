@model FirstREST.Models.ShoppingCart

@{
    ViewBag.Title = "ArtigoPage";
    var artigo = ViewBag.artigo;
}
<div id="artigopage" class="container">
    <div class="row">
        <div class="col-md-4 item-photo">
            <img height="400" src="~/Images/@{@artigo.CodArtigo}.jpg" />
        </div>
        <div class="col-xs-5" style="border:0px solid gray">
 
            <h1>@artigo.DescArtigo</h1>
            <h6><small>de  </small> @artigo.AutorArtigo</h6>
            <h4 style="margin-top:10px;">
                <span class="stars">
                                        @for (int stars = 1; stars <= artigo.PesoLArtigo; stars++)
                    {
                                            <i class="glyphicon glyphicon-star" style="color:#FFD700"></i>
                    }
                </span>
            </h4>

            <h2 style="margin-top:35px; margin-bottom:15px;">@artigo.precomIvaArtigo €</h2>
            

            <div class="section" style="padding-bottom:5px;">
                <h6 class="title-attr"><small>Warehouse</small></h6>
                <select id="wh">
                    @{foreach (var wh in artigo.armArtigo)
                    {
                        <option value="@wh.descArmazens">@wh.descArmazens</option>
                    }
                    }
                </select>

            </div>
            <div class="section" style="padding-bottom:20px;">
                <h6 class="title-attr"><small>Quantity</small></h6>
                <div>
                    <div class="btn-minus"><span class="glyphicon glyphicon-minus"></span></div>
                    <input value="1" />
                    <div class="btn-plus"><span class="glyphicon glyphicon-plus"></span></div>
                </div>
            </div>

            <!-- Botones de compra -->
            <div class="section" style="padding-bottom:20px;">
                <button class="btn btn-success"><span style="margin-right:20px" class="glyphicon glyphicon-shopping-cart" aria-hidden="true"></span> Add to cart</button>
                
            </div>
        </div>
        <div style="margin-top:15px;"class="col-xs-10">
            <h3>Sinopse</h3>
            <p align="justify" style="font-size:16px;" >@artigo.SinopseArtigo</p>
        </div>
    </div>
</div>      

<script>
    $(function () {
        $("#addtoCart").on('submit', function (e) {
            e.preventDefault() // prevent the form's normal submission
                    var dataToPost = {
                        CodArtigo: $("#title-art-page").text(),
                        DescArtigo: $("#desc").text(),
                        PrecoArtigo: parseFloat($("#preco").val()),
                        ArmazemArtigo: $("#wh option:selected").text(),
                        QuantidadeArtigo: parseInt($("#qt").val()),
                    }

                    $.post("/ShoppingCart/AddtoCart", dataToPost)
                        .done(function (r) {
                            console.log("Added product successfully!");
                        })
                        .fail(function (r) {
                            console.log("Failed to add the product to the shopping cart");
                            window.location.assign("http://localhost:49822/Account/login/");
                        })
        })

        $("#goToLogin").on('click', function () {
            window.location.assign("http://localhost:49822/Account/login/");
        })
    })
</script>